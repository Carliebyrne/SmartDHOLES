{% extends 'mainapp/base.html' %}
{% load staticfiles %}
{% block content %}
<div class="row flex-xl-nowrap row-eq-height">
<div class="col-12 col-md-3 col-xl-3 bd-sidebar bg-dark p-0" role="navigation" id="left-panel">
      <ul class="nav flex-column left-panel">
        <li class="nav-item left-panel-droopdown clearfix" status="closed">
          <a class="nav-link text-light" href="#">
            <i class="fa fa-th"></i> Tables <i class="float-right fa fa-caret-right"></i>
          </a>
        </li>

          <ul id="left-panel-tables" class="nav flex-column" style="display:none" role="menu">
            {% for table_name in tks %}
            <li class="nav-item"><a data-toggle="tooltip" data-placement="right" title="{{ table_name }}" class="nav-link pl-4 text-truncate text-light" href="{% url 'mainapp:reflector' table_name %}">{{ table_name }}</a></li>
            {% endfor %}
          </ul>

        <li class="nav-item"><a class="nav-link text-light" href="{% url 'mainapp:add_table' %}">Add Table</a></li>
        <li class="nav-item"><a class="nav-link text-light" href="#">Remove Table</a></li>
      </ul>
</div>
<div class="col-12 col-md-9">
  <div class="pull-right" style="padding-bottom:30px;">
    <a href="{% url 'mainapp:generic_add' table_key %}" class="btn btn-success"><span class="fa fa-ok"></span> New</a>
  </div>

  <form action="." method="post">
{% csrf_token %}
<input type="hidden" name="tablename" value={{ table_key }}>
  <div style="margin-top:20px;">
  <table class="table table-condensed table-hover table-bordered table-striped table-responsive">
  <caption>smart drillholes table: <strong>{{table_key}}</strong></caption>
  <thead class="thead-inverse">
  <tr>
  {% for col in cols %}
  <th>
      {{ col.name }}
      {{ col.type }}
      {% if col.primary_key %}<span><img src="{% static 'img/pk.png' %}" class="img-responsive" alt="primarykey image"></span>{% endif %}
      {% if col.foreign_key %}<span><img src="{% static 'img/fk.png' %}" class="img-responsive" alt="foreignkey image"></span>{% endif %}
      {% if col.unique %}U{% endif %}
      {% if col.nullable %}N{% endif %}
  </th>
  {% endfor %}
  <th><i class="fa fa-trash"></i></th>
  </tr>
  </thead>
  <tbody>
    {% for dat in data %}
    <tr>
      {% for d in dat.data %}
    <td>
      {{ d }}
    </td>
      {% endfor %}
      <td>
        <label class="custom-control custom-checkbox">
        <input name="checkbox-delete" value="{{ dat.pks }}" type="checkbox" class="custom-control-input">
        <span class="custom-control-indicator"></span>
        </label>
      </td>
  </tr>
    {% endfor %}

  </tbody>
  </table>
  </div>

  <div class="pull-right" style="padding-bottom:30px;">
    <button type="submit" id="btnsave"  class="btn btn-success"><span class="glyphicon glyphicon-ok"></span> Save</button>
  </div>

    </form>

</div>
</div>
{% endblock %}

{% block javascript %}

<script>
$(document).ready(function(){
$('.left-panel-droopdown').find('a').tooltip();
$("#llbtnsave").click(function(evento){

//evento.preventDefault();
$.ajax({
  type: 'POST',
  url: "{% url 'mainapp:reflector' %}",
});

});
$(".left-panel-droopdown").click(function(evento){
  evento.preventDefault();
  if($(this).attr('status')=="closed"){
    $('ul#left-panel-tables').attr('style','display:flex');
    $(this).find('i.fa.fa-caret-right').attr('style','transform: rotate(90deg)');
    $(this).attr('status','open');
  }else{
    $('ul#left-panel-tables').attr('style','display:none');
    $(this).find('i.fa.fa-caret-right').attr('style','transform: rotate(0deg)');
    $(this).attr('status','closed');
  }
});
});
</script>
{% endblock javascript %}
